"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.LoginForm = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_router_dom_1 = require("react-router-dom");
const App_1 = require("./App");
const react_1 = __importDefault(require("react"));
const useForm_1 = require("../hooks/useForm");
const useToast_1 = require("./useToast");
function LoginForm() {
    const navigate = (0, react_router_dom_1.useNavigate)();
    const [handleSubmit, register, formRef] = (0, useForm_1.useForm)((fd) => { var _a, _b, _c, _d; return ({ email: (_b = (_a = fd.get('email')) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : '', password: (_d = (_c = fd.get('password')) === null || _c === void 0 ? void 0 : _c.toString()) !== null && _d !== void 0 ? _d : '' }); }, { email: '', password: '' });
    const submitter = (credentials) => App_1.realmApp.logIn(Realm.Credentials.emailPassword(credentials.email, credentials.password));
    const successToast = (0, useToast_1.useToast)('success');
    const failureToast = (0, useToast_1.useToast)('failure');
    const onSubmit = react_1.default.useMemo(() => handleSubmit(submitter, (user) => {
        (0, App_1.$currentUser)(user);
        navigate('/');
        successToast('You have successfully logged in', 'SUCCESSFUL LOG-In', user === null || user === void 0 ? void 0 : user.profile.email);
    }, (err) => { var _a; return failureToast((_a = err === null || err === void 0 ? void 0 : err.message) !== null && _a !== void 0 ? _a : 'Error logging in.', 'FAILED LOG-IN'); }), [failureToast, handleSubmit, navigate, successToast]);
    return ((0, jsx_runtime_1.jsxs)("form", Object.assign({ className: 'grid grid-col-1', onSubmit: onSubmit, ref: formRef }, { children: [(0, jsx_runtime_1.jsxs)("div", Object.assign({ className: 'flex flex-col' }, { children: [(0, jsx_runtime_1.jsx)("label", Object.assign({ htmlFor: 'email', id: 'email-label', className: 'flex text-lg font-bold indent-3 font-fira-sans' }, { children: "E-mail" })), (0, jsx_runtime_1.jsx)("input", Object.assign({ type: 'email', className: 'flex font-fira-sans text-base px-2 py-0.5 rounded-lg border border-black shadow-inner shadow-black bg-white' }, register('email')))] })), (0, jsx_runtime_1.jsxs)("div", Object.assign({ className: 'flex flex-col' }, { children: [(0, jsx_runtime_1.jsx)("label", Object.assign({ htmlFor: 'password', id: 'password-label', className: 'flex text-lg font-bold indent-3 font-fira-sans' }, { children: "Password" })), (0, jsx_runtime_1.jsx)("input", Object.assign({ type: 'password', className: 'flex font-fira-sans text-base px-2 py-0.5 rounded-lg border border-black shadow-inner shadow-black bg-white' }, register('password')))] })), (0, jsx_runtime_1.jsx)("input", { type: 'submit', className: 'flex border border-black bg-blue-dark py-0.5 px-2 rounded-lg shadow-inner shadow-black text-white text-lg font-bold font-fira-sans' })] })));
}
exports.LoginForm = LoginForm;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTG9naW5Gb3JtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvTG9naW5Gb3JtLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsdURBQStDO0FBQy9DLCtCQUErQztBQUMvQyxrREFBMEI7QUFDMUIsOENBQTJDO0FBQzNDLHlDQUFzQztBQUV0QyxTQUFnQixTQUFTO0lBQ3JCLE1BQU0sUUFBUSxHQUFHLElBQUEsOEJBQVcsR0FBRSxDQUFDO0lBQy9CLE1BQU0sQ0FBQyxZQUFZLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxHQUFHLElBQUEsaUJBQU8sRUFDN0MsQ0FBQyxFQUFFLEVBQUUsRUFBRSx1QkFBQyxPQUFBLENBQUMsRUFBRSxLQUFLLEVBQUUsTUFBQSxNQUFBLEVBQUUsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLDBDQUFFLFFBQVEsRUFBRSxtQ0FBSSxFQUFFLEVBQUUsUUFBUSxFQUFFLE1BQUEsTUFBQSxFQUFFLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQywwQ0FBRSxRQUFRLEVBQUUsbUNBQUksRUFBRSxFQUFFLENBQUMsQ0FBQSxFQUFBLEVBQ3RHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLENBQzlCLENBQUM7SUFDRixNQUFNLFNBQVMsR0FBRyxDQUFDLFdBQWlELEVBQUUsRUFBRSxDQUFDLGNBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztJQUNsSyxNQUFNLFlBQVksR0FBRyxJQUFBLG1CQUFRLEVBQUMsU0FBUyxDQUFDLENBQUM7SUFDekMsTUFBTSxZQUFZLEdBQUcsSUFBQSxtQkFBUSxFQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3pDLE1BQU0sUUFBUSxHQUFHLGVBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFNBQVMsRUFBRSxDQUFDLElBQW1DLEVBQUUsRUFBRTtRQUNqRyxJQUFBLGtCQUFZLEVBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkIsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsWUFBWSxDQUFDLGlDQUFpQyxFQUFFLG1CQUFtQixFQUFFLElBQUksYUFBSixJQUFJLHVCQUFKLElBQUksQ0FBRSxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDOUYsQ0FBQyxFQUFFLENBQUMsR0FBVyxFQUFFLEVBQUUsV0FBQyxPQUFBLFlBQVksQ0FBQyxNQUFBLEdBQUcsYUFBSCxHQUFHLHVCQUFILEdBQUcsQ0FBRSxPQUFPLG1DQUFJLG1CQUFtQixFQUFFLGVBQWUsQ0FBQyxDQUFBLEVBQUEsQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLFlBQVksRUFBRSxRQUFRLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQztJQUUvSSxPQUFPLENBQ0gsZ0RBQU0sU0FBUyxFQUFDLGlCQUFpQixFQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLE9BQU8saUJBQzlELCtDQUFLLFNBQVMsRUFBQyxlQUFlLGlCQUMxQixnREFBTyxPQUFPLEVBQUMsT0FBTyxFQUFDLEVBQUUsRUFBQyxhQUFhLEVBQUMsU0FBUyxFQUFDLGdEQUFnRCw0QkFFMUYsRUFDUixnREFDSSxJQUFJLEVBQUMsT0FBTyxFQUNaLFNBQVMsRUFBQyw2R0FBNkcsSUFDbkgsUUFBUSxDQUFDLE9BQU8sQ0FBQyxFQUFJLEtBQzNCLEVBQ04sK0NBQUssU0FBUyxFQUFDLGVBQWUsaUJBQzFCLGdEQUFPLE9BQU8sRUFBQyxVQUFVLEVBQUMsRUFBRSxFQUFDLGdCQUFnQixFQUFDLFNBQVMsRUFBQyxnREFBZ0QsOEJBRWhHLEVBQ1IsZ0RBQ0ksSUFBSSxFQUFDLFVBQVUsRUFDZixTQUFTLEVBQUMsNkdBQTZHLElBQ25ILFFBQVEsQ0FBQyxVQUFVLENBQUMsRUFBSSxLQUM5QixFQUNOLGtDQUNJLElBQUksRUFBQyxRQUFRLEVBQ2IsU0FBUyxFQUFDLG9JQUFvSSxHQUFHLEtBQ2xKLENBQ1YsQ0FBQztBQUNOLENBQUM7QUF4Q0QsOEJBd0NDIn0=